<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dancing Snowman</title>
    <link href="style.css" media="screen" rel="stylesheet" type="text/css">
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport">
    <link href="favicon.ico" rel="shortcut icon" type="image/png">
    <link href="https://www.dancingsnowman.com" rel="canonical">
    <meta content="Dineshraj Goomani" name="author">
    <meta content="Dancing Snowman" name="description">
    <!-- Schema.org markup for Google+ -->
    <meta content="Dancing Snowman" itemprop="name">
    <meta content="Dancing Snowman" itemprop="description">
    <meta content="src/social.jpg" itemprop="image">
    <!-- Twitter Card data -->
    <meta content="summary_large_image" name="twitter:card">
    <meta content="c" name="twitter:title">
    <meta content="Dancing Snowman" name="twitter:description">
    <!-- Twitter summary card with large image must be at least 280x150px -->
    <meta content="src/social.jpg" name="twitter:image:src">
    <meta content="src/social.jpg" name="twitter:image">
    <meta content="https://www.dancingsnowman.com" name="twitter:url">
    <!-- Open Graph data -->
    <meta content="Dancing Snowman" property="og:title">
    <meta content="article" property="og:type">
    <meta content="https://www.dancingsnowman.com" property="og:url">
    <meta content="src/social.jpg" property="og:image">
    <meta content="Dancing Snowman" property="og:description">
    <meta content="Dancing Snowman" property="og:site_name">
    <meta content="en_GB" property="og:locale">

    <meta content="d3HhJZ1wlOD9qoMvrcroUxkEWkWpdMvLT-YjsiPLcMs" name="google-site-verification"/>
  </head>
  <body>
    <a class="mobile-link">
      <span class="mobile-link__go">Click to go!</span>
    </a>

    <div class="media">
      <audio class="media__audio" loop>
        <source src="src/snowman-song.mp3" type="audio/mpeg"/>
      </audio>
      <div class="animation">
        <div class="animation__spinner"></div>
        <img class="animation__image" src="src/frame.jpg"/>
      </div>
    </div>

    <a class="credit" href="http://www.dineshraj.com">by Dineshraj</a>
    <script>
      function playAnimation() {
        document.getElementsByClassName("media__audio")[0].play();
        // when playing remove static image
        var animationImage = document.querySelector(".animation__image");
        var hiddenAnimation = document.querySelector(".hidden_animation");

        animationImage.parentNode.removeChild(animationImage);
        hiddenAnimation.classList.add("animation__image");
        hiddenAnimation.classList.remove("hidden_animation");
      }

      function getCorrectImage() {
        var tinyScreen = window.innerWidth <= 400;
        var smallScreen = window.innerWidth <= 1024;
        var isDesktop =
          !("ontouchstart" in window) || !("onmsgesturechange" in window);

        if (tinyScreen && !isDesktop) {
          return "lo.gif";
        } else if (smallScreen && !isDesktop) {
          return "med.gif";
        }
        return "hi.gif";
      }

      function play() {
        document.querySelector('.mobile-link').style.display = 'none';
        playAnimation();
      }

      window.onload = function() {
        var img = document.createElement('img'); 
        var animation = document.querySelector('.animation');
        var goLink = document.querySelector('.mobile-link');
        animation.appendChild(img);

        img.onload = function () {
          document.querySelector('.animation__spinner').style.display = 'none';
          document.querySelector('.mobile-link__go').style.display = 'block';

          goLink.addEventListener('click', function (e) {
            play();
          });
          goLink.addEventListener('touchstart', function (e) {
            play();
          });
        }

        img.src = "src/snowman-" + getCorrectImage();
        img.classList.add('hidden_animation');
      };
    </script>
    <script>
      (function(i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        (i[r] =
          i[r] ||
          function() {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        "script",
        "https://www.google-analytics.com/analytics.js",
        "ga"
      );

      ga("create", "UA-81644572-3", "auto");
      ga("send", "pageview");
    </script>
  </body>
</html>
